<div class="rating-modal-container">
    <div class="flex flex-row ratings-container">
        <div class="flex-1">
            <ws-widget-rating-summary [ratingSummary]="data?.ratings"></ws-widget-rating-summary>
        </div>
        <div class="flex">
            <mat-icon class="cursor-pointer" (click)="handleCloseModal()" >close</mat-icon>
        </div>
    </div>
    <div class="flex flex-col p-6">
        <div class="flex flex-col gap-4">
            <div class="font-base font-bold">
                <span *ngIf="showFilterIndicator === 'Top'">{{ 'mobileApp.mLearnCourseTopReviews' | translate }}</span>
                <span *ngIf="showFilterIndicator !== 'Top'">{{ 'mobileApp.mLearnCourselatestReviews' | translate }}</span>
            </div>
            <div class="flex flex-row gap-3">
                <div class="flex-1">
                    <div class="flex flex-row search-div">
                        <mat-icon (click)="handleFocus()" class="cursor-pointer">search</mat-icon>
                        <input #searchInput type="text" class="search-input flex" placeholder="Search" maxlength="50" />
                        <ng-container *ngIf="clearIcon">
                            <mat-icon (click)="handleClear()" class="cursor-pointer">close</mat-icon>
                        </ng-container>
                    </div>
                </div>
                <div class="flex items-center justify-center w-8">
                    <mat-icon class="cursor-pointer" [matMenuTriggerFor]="filter">filter_list</mat-icon>
                    <mat-menu #filter="matMenu" xPosition="before">
                        <button mat-menu-item class="px-3" [ngClass]="{'highlightFilter': showFilterIndicator === 'Latest'}"
                            (click)="handleReviewsFilter('Latest')">
                            <span>{{ 'apptocsinglepage.latestReviews' | translate }}</span>
                        </button>
                        <button mat-menu-item class="px-3" [ngClass]="{'highlightFilter': showFilterIndicator === 'Top'}"
                            (click)="handleReviewsFilter('Top')">
                            <span>{{ 'apptocsinglepage.topReviews' | translate }}</span>
                        </button>
                    </mat-menu>
                </div>
            </div>
        </div>
        <div class="flex flex-col reviews" infiniteScroll [infiniteScrollDistance]="1" [infiniteScrollThrottle]="150" [infiniteScrollContainer]="'.reviews'" [fromRoot]="true" [scrollWindow]="false" (scrolled)="handleLoadMore()">
            <ng-container *ngFor="let eachReview of reviews; let i = index">
                <div class="flex flex-row gap-3 p-4">
                    <div class="flex-1">
                        <div class="flex flex-col gap-6">
                            <div class="flex text-sm">{{ handleCapitalize(eachReview?.review) }}</div>
                            <div class="flex flex-row gap-2 items-center">
                                <ws-widget-avatar-photo [randomColor]="true" [datalen]="1" [size]="'round-m'" [photoUrl]="eachReview?.photo || ''" [name]="eachReview?.firstName"></ws-widget-avatar-photo>
                                <div class="text-sm">{{ handleCapitalize(eachReview?.firstName) }}</div>
                                <div class="flex items-center">
                                    <span class="period"></span>
                                </div>
                                <div class="text-sm">{{ eachReview?.updatedon | pipeRelativeTime }}</div>
                            </div>
                        </div>
                    </div>
                    <div class="flex flex-row gap-1 rating-start-value">
                        <mat-icon>star</mat-icon>
                        <div class="text-sm">{{ eachReview?.rating }}</div>
                    </div>
                </div>
                <div class="separator" *ngIf="reviews.length > (i + 1)" ></div>
            </ng-container>
            <div *ngIf="displayLoader" class="flex items-center justify-center mt-6">
                <mat-spinner [diameter]="30"></mat-spinner>
            </div>
        </div>
    </div>
    
</div>

