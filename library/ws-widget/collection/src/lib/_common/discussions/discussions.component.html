<div class="flex-1 flex-col">
    <ng-container *ngIf="discussion.loadSkeleton">
        <div class="flex flex-col gap-3">
            <div class="flex flex-col gap-3 p-5" *ngFor="let i of countArr">
                <ws-widget-skeleton-loader [bindingClass]="'flex rounded h-6'"></ws-widget-skeleton-loader>
                <ws-widget-skeleton-loader [bindingClass]="'flex rounded h-6'"></ws-widget-skeleton-loader>
                <div class="flex flex-row gap-5 justify-around">
                    <ws-widget-skeleton-loader [width]="'64px'" [height]="'48px'"
                        [bindingClass]="'flex rounded h-8'"></ws-widget-skeleton-loader>
                    <ws-widget-skeleton-loader [width]="'64px'" [height]="'48px'"
                        [bindingClass]="'flex rounded h-8'"></ws-widget-skeleton-loader>
                    <ws-widget-skeleton-loader [width]="'64px'" [height]="'48px'"
                        [bindingClass]="'flex rounded h-8'"></ws-widget-skeleton-loader>
                </div>
            </div>
        </div>
    </ng-container>

    <ng-container *ngIf="!discussion.loadSkeleton">
        <ng-container *ngIf="!discussion?.data?.length && !discussion.error">
            <div class="flex flex-col items-center gap-4 p-5">
                <img src="assets/icons/home/chat.svg" alt="chat img" />
                <div class="text-sm text-center">Do you have any questions, suggestions or, ideas in your mind? Post it.
                </div>
                <button
                    class="bg-blue-700 text-sm font-semibold text-white py-3 px-5 rounded-full border-none cursor-pointer tracking-wide"
                    [routerLink]="['/app/discussion-forum']" [queryParams]="{page: 'home'}">Start discussion</button>
            </div>
        </ng-container>

        <ng-container *ngIf="discussion?.data?.length">
            <div class="flex flex-col" [ngClass]="{'gap-4': trend}">
                <ng-container *ngFor="let data of discussion.data | slice:0:count; let i = index">
                    <div class="flex flex-col gap-2 p-4 hover-card" [ngClass]="{'discuss-card': (!trend && i===0), 'discussion-card': trend}" (click)="handleSelectedDiscuss(data, trend)"  >
                        <div class="flex flex-row gap-2 items-center">
                            <div class="initial-circle rounded-full border-1 text-white leading-3 capitalize"
                                [style.background]="data?.user['icon:bgColor']">
                                {{ data?.user['icon:text'] }}
                            </div>
                            <div class="text-sm">{{ data?.user?.displayname || 'Anonymous' }}</div>
                            <div>.</div>
                            <div class="text-sm">{{ data?.timestamp | pipeRelativeTime }}</div>
                        </div>
                        <div class="text-sm" [innerHtml]="data?.topic?.title || data?.title"></div>
                        <div class="flex flex-row gap-5">
                            <div class="flex flex-row gap-2">
                                <mat-icon>swap_vert</mat-icon>
                                <div class="text-xs">{{ (data?.upvotes + data?.downvotes) || 0 }} {{ 'discuss.discussionVotes' | translate }}</div>
                            </div>
                            <div class="flex flex-row gap-2" *ngIf="trend" >
                                <mat-icon>visibility</mat-icon>
                                <div class="text-xs">{{ data?.viewcount || 0 }} {{ 'discuss.discussionViews' | translate }}</div>
                            </div>
                            <div class="flex flex-row gap-2">
                                <mat-icon>chat_bubble</mat-icon>
                                <div class="text-xs">{{ (( (data?.topic?.postcount || data?.postcount) || 1) -1) }} {{ 'discuss.comments' | translate }}
                                </div>
                            </div>
                        </div>
                    </div>
                </ng-container>
            </div>
        </ng-container>

        <ng-container *ngIf="discussion.error">
            <div class="flex flex-col items-center gap-3 p-5">
                <mat-icon class="no-data-found">report_off</mat-icon>
                <div class="mat-subheading-1">{{ 'home.noDataFound' | translate }}</div>
                <div class="text-center">Unable to fetch discussion info due to some error.</div>
            </div>
        </ng-container>
    </ng-container>
</div>
