<viewer-overview *ngIf="viewState === 'initial'" [learningObjective]="learningObjective"
  [complexityLevel]="complexityLevel" [duration]="duration" [timeLimit]="getTimeLimit"
  [primaryCategory]="primaryCategory" [canAttempt]="canAttempt" [noOfQuestions]="noOfQuestions"
  (userSelection)="getSections($event)">
</viewer-overview>

<!-- Desktop -->
<div #quizContainer class="quiz-container" *ngIf="viewState !== 'initial' && !isMobile && fetchingQuestionsStatus === 'done'">
  <!-- <div class="flex flex-column quiz_inner_container"> -->
  <!-- <nav class="quiz-nav-bar mat-toolbar mat-caption flex-column">
      <div class="flex flex-1">
        <button *ngIf="isXsmall && !isSubmitted" mat-icon-button aria-label="menu toggle" i18n-aria-label
          (click)="sidenav.toggle()">
          <mat-icon aria-label="open questions navigation">menu</mat-icon>
        </button>
        <a mat-button *ngIf="!isSubmitted && viewState !== 'detail' && !isOnlySection" (click)="backToSections()"
          class="flex cursor-pointer">
          <mat-icon class="ws-mat-default-text m-auto">arrow_back</mat-icon>
          <span class="ws-mat-default-text subheading-1">Back to sections</span>
        </a>
        <a disableRipple
          *ngIf="primaryCategory === ePrimaryCategory.PRACTICE_RESOURCE && !isSubmitted && viewState === 'detail'"
          i18n-aria-label aria-label="Back" (click)="back()" class="no-border flex cursor-pointer back_button">
          <mat-icon class="ws-mat-default-text">arrow_back</mat-icon>
          <span class="ws-mat-default-text subheading-1">Back to home </span>
        </a>
        <ng-container *ngIf="(!isSubmitted && viewState !== 'detail') ||
        (primaryCategory === ePrimaryCategory.PRACTICE_RESOURCE && !isSubmitted && viewState === 'detail')">
          <span class="spacer"></span>
        </ng-container>
        <div class="flex flex-1 flex-end">
          <ws-widget-btn-fullscreen [widgetType]="'actionButton'" [widgetSubType]="'actionButtonFullscreen'"
            [widgetData]="{ fsContainer: quizContainer }"></ws-widget-btn-fullscreen>
        </div>
      </div>

      <div *ngIf="viewState === 'detail'" class="flex flex-column flex-center">
        <ng-container [ngTemplateOutlet]="timer"></ng-container>
      </div>
      <div class="flex flex-column flex-end">
        <div *ngIf="viewState === 'detail'" class="flex flex-column">
          <ng-container [ngTemplateOutlet]="indicator"></ng-container>
        </div>
      </div>
    </nav> -->


  <div class="flex flex-row margin-m"
    *ngIf="fetchingQuestionsStatus === 'done' && viewState !== 'detail' && !(viewState === 'answer') && !isSubmitted">
    <div class="left-container">
      <div class="flex flex-row justify-between align-center assessment-header">
        <div>
          <div (click)="back()" class="no-border flex cursor-pointer back_button">
            <span class="subheading-back">{{resourceName}}</span>
          </div>
        </div>
        <div>
          <div class="flex flex-1 flex-row-reverse butto_box end">
            <ng-container
              *ngIf="!allSecAttempted.full && allSecAttempted.next && ((currentQuestionIndex+1) === totalQCount)">
              <button class="text-white ws-mat-primary-background margin-xs quest_btn" mat-raised-button
                (click)="nextSection(allSecAttempted.next)" i18n="button quiz submit">
                Next Section
              </button>
            </ng-container>
            <a *ngIf="(currentQuestionIndex+1) !== totalQCount"
              class="text-white ws-mat-primary-background margin-xs quest_btn" mat-button
              (click)="getNextQuestion(currentQuestionIndex + 1)">
              <ng-container *ngIf="!isXsmall">Next</ng-container>
            </a>
            &nbsp;&nbsp;
            <a *ngIf="(currentQuestionIndex + 1) === totalQCount"
              class="text-white ws-mat-primary-background margin-xs quest_btn" mat-button (click)="proceedToSubmit()">
              <ng-container *ngIf="!isXsmall">Submit</ng-container>
            </a>
            &nbsp;&nbsp;
            <a *ngIf="currentQuestionIndex !== 0" class="ws-mat-accent-border margin-xs quest_btn" mat-button
              (click)="getNextQuestion(currentQuestionIndex - 1)">
              <ng-container *ngIf="!isXsmall">Previous</ng-container>
            </a>

            <!-- <button class="text-white ws-mat-primary-background" mat-raised-button i18n="button quiz submit"
              (click)="proceedToSubmit()">
              Finish assessment
            </button> -->
          </div>
        </div>
      </div>

      <div class="border-outline">
        <div class="flex flex-1">
          <mat-progress-bar class="quiz-progress" [color]="secondary" [mode]="determinate"
            [value]="((currentQuestionIndex + 1)/totalQCount)*100" [bufferValue]="100">
          </mat-progress-bar>
        </div>
        <ng-container *ngIf="current_Question && !process">
          <viewer-question #questionsReference [id]="'question' + (currentQuestionIndex + 1)"
            [markedQuestions]="markedQuestions" [artifactUrl]="artifactUrl" [questionNumber]="currentQuestionIndex + 1"
            [total]="secQuestions.length" [viewState]="viewState" [question]="current_Question"
            [itemSelectedList]="questionAnswerHash[(current_Question?.questionId)]" [primaryCategory]="primaryCategory"
            [ePrimaryCategory]="ePrimaryCategory"
            [totalQCount]="totalQCount"
            (itemSelected)="fillSelectedItems(current_Question, $event)"
            [showAnswer]="showAnswer"
            [current_Question]="current_Question"
            >
          </viewer-question>
        </ng-container>
        <div class="flex flex-1">
          <!-- <ng-container
            *ngIf="ePrimaryCategory.PRACTICE_RESOURCE === primaryCategory && ((currentQuestionIndex+1) <= totalQCount)">
            <button *ngIf="!showAnswer" class="text-white ws-mat-primary-background margin-xs quest_btn"
              mat-raised-button (click)="checkAns(currentQuestionIndex + 1)" i18n="button quiz correct answer">
              Check Answer
            </button>
          </ng-container> -->
          <div class="flex flex-1 flex-row-reverse margin-right-m butto_box end">
            <ng-container
              *ngIf="!allSecAttempted.full && allSecAttempted.next && ((currentQuestionIndex+1) === totalQCount)">
              <button class="text-white ws-mat-primary-background margin-xs quest_btn" mat-raised-button
                (click)="nextSection(allSecAttempted.next)" i18n="button quiz submit">
                Next Section
              </button>
            </ng-container>
          </div>
        </div>
        <ng-template *ngIf="!(current_Question && !process)" [ngTemplateOutlet]="showLoading"></ng-template>
      </div>

    </div>
    <div class="right-container">
      <div class="question-list">
        <div class="ques_stats_container">
          <div class="flex flex-row justify-between">
            <p class="mat-subheading-1">
              Questions
            </p>
            <div class="timer">
              <mat-chip-list><mat-chip class="light-blue"><span class="chip-text">
                  <ng-container [ngTemplateOutlet]="timer"></ng-container>
                </span>
              </mat-chip></mat-chip-list>
            </div>
          </div>
          <div class="seperator"></div>
          <div class="mb-24">
            <div class="flex flex-row justify-around">
              <div class="flex flex-col align-center">
                <div class="ques-count">{{totalQCount - questionAttemptedCount}}</div>
                <div class="stats-label">Not answered</div>
              </div>
              <div class="flex flex-col align-center">
                <div class="ques-count">{{questionAttemptedCount ? questionAttemptedCount  : 0}}</div>
                <div class="stats-label">Answered</div>
              </div>
              <!-- <div class="flex flex-col align-center">
                <div class="ques-count">{{markedQuestions.size}}</div>
                <div class="stats-label">Skipped</div>
              </div> -->
            </div>
          </div>
          <div class="seperate-text">
            <span>Questions</span>
          </div>
          <!-- <div class="flex flex-row justify-between">

            <div class="flex flex-row center-text">
              <div class="answer-stats-label">Answered&nbsp;</div>
              <div><mat-chip-list><mat-chip class="light-blue-small">&nbsp;&nbsp;&nbsp;&nbsp;</mat-chip></mat-chip-list>
              </div>
            </div>
            <div class="flex flex-row center-text answer-stats-label">
              Not Answered &nbsp;<mat-checkbox class="example-margin"></mat-checkbox>
            </div>
            <div class="flex flex-row center-text">
              <div class="answer-stats-label">Skipped&nbsp;</div>
              <div><mat-chip class="orange-small">&nbsp;&nbsp;&nbsp;&nbsp;</mat-chip></div>
            </div>
          </div> -->
        </div>
        <!-- <div class="seperator"></div> -->
        <div *ngIf="!isSubmitted && !isXsmall && viewState === 'attempt'" class="flex flex-1">
          <ng-template *ngIf="fetchingQuestionsStatus === 'fetching'" [ngTemplateOutlet]="showLoading"></ng-template>
          <div class="flex flex-nowrap margin-right-s margin-left-s quest_num_box"
            *ngIf="fetchingQuestionsStatus === 'done'">
            <div class="col" *ngFor="let question of secQuestions; let i = index">
              <div (click)="scroll(i + 1)" [ngClass]="{
                'marked-question': isQuestionMarked(question?.questionId),
                'attempted-question':
                  !isQuestionMarked(question?.questionId) &&
                  isQuestionAttempted(question?.questionId),
                'white-border':
                  !isQuestionMarked(question?.questionId) &&
                  !isQuestionAttempted(question?.questionId) &&
                  currentTheme === 'black-theme',
                'dark-border':
                  !isQuestionMarked(question?.questionId) &&
                  !isQuestionAttempted(question?.questionId) &&
                  currentTheme !== 'black-theme'
              }" class="margin-xs">
                <div *ngIf="!isQuestionMarked(question?.questionId) &&
                  isQuestionAttempted(question?.questionId)"  class="light-blue-small">
                  <img class="margin-center" src="assets/icons/final-assessment/correct_arrow.svg"/>
                </div>
                <div *ngIf="isQuestionMarked(question?.questionId) && !(!isQuestionMarked(question?.questionId) &&
                  isQuestionAttempted(question?.questionId))">
                  <mat-chip-list><mat-chip class="orange-small">{{ i + 1 }}</mat-chip></mat-chip-list>
                </div>
                <div *ngIf="!(!isQuestionMarked(question?.questionId) &&
                  isQuestionAttempted(question?.questionId)) && (!isQuestionMarked(question?.questionId))"
                  class="ovel question-number"><span class="mat-body-2">
                    {{ i + 1 }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- 
    <div *ngIf="!isSubmitted && !isXsmall && viewState === 'attempt'" class="flex flex-1">
      <ng-template *ngIf="fetchingQuestionsStatus === 'fetching'" [ngTemplateOutlet]="showLoading"></ng-template>
      <div class="flex flex-nowrap margin-right-s margin-left-s quest_num_box"
        *ngIf="fetchingQuestionsStatus === 'done'">
        <div class="col" *ngFor="let question of secQuestions; let i = index">
          <div (click)="scroll(i + 1)" [ngClass]="{
          'marked-question': isQuestionMarked(question?.questionId),
          'attempted-question':
            !isQuestionMarked(question?.questionId) &&
            isQuestionAttempted(question?.questionId),
          'white-border':
            !isQuestionMarked(question?.questionId) &&
            !isQuestionAttempted(question?.questionId) &&
            currentTheme === 'black-theme',
          'dark-border':
            !isQuestionMarked(question?.questionId) &&
            !isQuestionAttempted(question?.questionId) &&
            currentTheme !== 'black-theme'
        }" class="margin-xs ovel">
            <div class="question-number"><span class="mat-body-2">{{ i + 1 }}</span></div>
          </div>
        </div>
      </div>
    </div>
    <mat-card class="flex flex-1 flex-column margin-m pad-0 quest_mat_card"
      *ngIf="fetchingQuestionsStatus === 'done' && viewState !== 'detail' && !(viewState === 'answer') && !isSubmitted">
      <ng-container *ngIf="true">

      </ng-container>
    </mat-card> -->



  <!-- <ng-container *ngIf="fetchingQuestionsStatus === 'done'  && current_Question && !process">
      <ng-container *ngIf="viewState === 'attempt' && !isSubmitted">
        <div class="flex flex-1 flex-column margin-top-l margin-left-xs bottom_box margin-bottom-xs">
          <div class="flex flex-start margin-left-m  cen">
            <mat-icon class="flex margin-top-xs margin-bottom-xs">warning</mat-icon>
            <span class="flex mat-body-2 padding-xs font-weight-700" i18n>Instructions </span>
            <span class="flex mat-body-2 font-weight-700" i18n>:</span>
            <span [innerHtml]="formate(selectedSection.additionalInstructions)"></span>
          </div>
          <div class="flex flex-start margin-left-m  cen">
            <mat-icon class="flex margin-top-xs margin-bottom-xs">info_outline</mat-icon>
            <span class="flex mat-body-2 padding-xs" i18n>Attempt all questions to finish assessment</span>
          </div>          
        </div>
      </ng-container>
    </ng-container> -->

  <div id="quiz-end"></div>
  <ng-container *ngIf="isSubmitted && (viewState === 'answer' || viewState === 'review')">
    <viewer-result [quizCategory]="primaryCategory" [quizResponse]="finalResponse" [percentage]="result"
      [isPassed]="finalResponse?.pass" (userSelection)="action($event)" (fetchResult)="getQuizResult()">
    </viewer-result>
  </ng-container>
  <!-- </div> -->
  <div *ngIf="viewState === 'detail'" class="flex flex-1 flex-column">
    <ng-container *ngIf="this.paperSections && this.paperSections?.length > 0">
      <div class="flex flex-1 flex-column margin-right-m margin-left-m main_practice_box">
        <div class="margin-m" *ngIf="fetchingSectionsStatus === 'fetching'">
          <div class="flex flex-center">
            <mat-spinner></mat-spinner>
          </div>
        </div>
        <div class="flex flex-1 flex-wrap margin-top-l">
          <ng-container *ngFor="let section of this.paperSections">
            <mat-card [ngClass]="getClass(section)"
              class="min-w assessment_card ws-mat-accent-border br-8 no-border margin-m">
              <mat-card-content class="cursor-pointer"
                [class.spinner]="fetchingQuestionsStatus === 'fetching' && section.identifier === selectedSection.identifier"
                [attr.disabled]="fetchingQuestionsStatus === 'fetching' && section.identifier === selectedSection.identifier"
                (click)="startSection(section)">
                <div class="flex flex-1 flex-column">
                  <span class="flex mat-subheading-1 text-truncate ">{{section.name || 'Section'}}</span>
                  <span class="flex mat-body-2">Percentage to pass - <ng-container>
                      {{section.minimumPassPercentage}}
                    </ng-container></span>
                  <span class="flex mat-body-2">Total questions - <ng-container>{{section?.maxQuestions ||
                      '0'}}
                    </ng-container></span>
                  <span [innerHtml]="formate(section.additionalInstructions)"></span>
                </div>
              </mat-card-content>
            </mat-card>
          </ng-container>
        </div>
      </div>
    </ng-container>
  </div>
</div>

<!-- Mobile -->
<div #quizContainer class="quiz-container" *ngIf="viewState !== 'initial' && isMobile && fetchingQuestionsStatus === 'done'">
  <div class="flex flex-column"
    *ngIf="fetchingQuestionsStatus === 'done' && viewState !== 'detail' && !(viewState === 'answer') && !isSubmitted">
      <div>
        <div class="flex flex-row justify-around align-end">
          <div>
            <img src="assets/icons/final-assessment/decline_icon.svg"/>
          </div>
          <div (click)="back()" class="no-border flex cursor-pointer back_button">
            <span class="subheading-back">{{resourceName}}</span>
          </div>
          <div class="timer">
            <mat-chip-list><mat-chip class="light-blue"><span class="chip-text">
                <ng-container [ngTemplateOutlet]="timer"></ng-container>
              </span>
            </mat-chip></mat-chip-list>
          </div>
        </div> 
        <div class="flex flex-column justify-between align-center assessment-header">           
          <div class="question-list">
            <div class="ques_stats_container">            
              <div class="mb-24">
                <div class="flex flex-row justify-around">
                  <div class="flex flex-col align-center">
                    <div class="ques-count">{{totalQCount - questionAttemptedCount}}</div>
                    <div class="stats-label">Not answered</div>
                  </div>
                  <div class="flex flex-col align-center">
                    <div class="ques-count">{{questionAttemptedCount ? questionAttemptedCount  : 0}}</div>
                    <div class="stats-label">Answered</div>
                  </div>
                  <!-- <div class="flex flex-col align-center">
                    <div class="ques-count">{{markedQuestions.size}}</div>
                    <div class="stats-label">Skipped</div>
                  </div> -->
                </div>
              </div>
              <div class="seperate-text">
                <span>Questions</span>
              </div>
              
          </div>
            
          </div>   
          <div class="exapnd-collapse">
            <div class="expand-icon" (click)="expandFalse = !expandFalse;">
              <mat-icon class="mat-icon notranslate material-icons mat-icon-no-color" role="img" aria-hidden="true">
                <span *ngIf="expandFalse">expand_more</span>
                <span *ngIf="!expandFalse">expand_less</span>
              </mat-icon>
            </div>
          </div> 
          <div>
            
            <!-- <div class="flex flex-row justify-between" *ngIf="!expandFalse">                  
              <div class="flex flex-row center-text">
                <div class="answer-stats-label">Answered&nbsp;</div>
                <div><mat-chip-list><mat-chip class="light-blue-small">&nbsp;&nbsp;&nbsp;&nbsp;</mat-chip></mat-chip-list></div>
              </div>
              <div class="flex flex-row center-text answer-stats-label">
                Not Answered &nbsp;<mat-checkbox class="example-margin"></mat-checkbox>
              </div>
              <div class="flex flex-row center-text">
                <div class="answer-stats-label">Skipped&nbsp;</div>
                <div><mat-chip class="orange-small">&nbsp;&nbsp;&nbsp;&nbsp;</mat-chip></div>
              </div>
            </div> -->
           
            <div *ngIf="!isSubmitted && viewState === 'attempt' && !expandFalse" class="flex flex-1">
              <ng-template *ngIf="fetchingQuestionsStatus === 'fetching'" [ngTemplateOutlet]="showLoading"></ng-template>
              <div class="flex flex-nowrap margin-right-s margin-left-s quest_num_box"
                *ngIf="fetchingQuestionsStatus === 'done'">
                <div class="col" *ngFor="let question of secQuestions; let i = index">
                  <div (click)="scroll(i + 1)" [ngClass]="{
                    'marked-question': isQuestionMarked(question?.questionId),
                    'attempted-question':
                      !isQuestionMarked(question?.questionId) &&
                      isQuestionAttempted(question?.questionId),
                    'white-border':
                      !isQuestionMarked(question?.questionId) &&
                      !isQuestionAttempted(question?.questionId) &&
                      currentTheme === 'black-theme',
                    'dark-border':
                      !isQuestionMarked(question?.questionId) &&
                      !isQuestionAttempted(question?.questionId) &&
                      currentTheme !== 'black-theme'
                  }" class="margin-xs">
                    <div *ngIf="!isQuestionMarked(question?.questionId) &&
                      isQuestionAttempted(question?.questionId)">
                      <mat-chip-list><mat-chip class="light-blue-small">&nbsp;&nbsp;&nbsp;&nbsp;</mat-chip></mat-chip-list>
                    </div>
                    <div *ngIf="isQuestionMarked(question?.questionId) && !(!isQuestionMarked(question?.questionId) &&
                      isQuestionAttempted(question?.questionId))">
                      <mat-chip-list><mat-chip class="orange-small">{{ i + 1 }}</mat-chip></mat-chip-list>
                    </div>
                    <div *ngIf="!(!isQuestionMarked(question?.questionId) &&
                      isQuestionAttempted(question?.questionId)) && (!isQuestionMarked(question?.questionId))"
                      class="ovel question-number"><span class="mat-body-2">
                        {{ i + 1 }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
          </div>
        </div>
  
        <div>
          <div class="flex flex-1">
            <mat-progress-bar class="quiz-progress" [color]="secondary" [mode]="determinate"
              [value]="((currentQuestionIndex + 1)/totalQCount)*100" [bufferValue]="100">
            </mat-progress-bar>
          </div>
          <ng-container *ngIf="current_Question && !process">
            <viewer-question #questionsReference [id]="'question' + (currentQuestionIndex + 1)"
              [markedQuestions]="markedQuestions" [artifactUrl]="artifactUrl" [questionNumber]="currentQuestionIndex + 1"
              [total]="secQuestions.length" [viewState]="viewState" [question]="current_Question"
              [itemSelectedList]="questionAnswerHash[(current_Question?.questionId)]" [primaryCategory]="primaryCategory"
              (itemSelected)="fillSelectedItems(current_Question, $event)"
              [ePrimaryCategory]="ePrimaryCategory"
              [totalQCount]="totalQCount"
              (itemSelected)="fillSelectedItems(current_Question, $event)"
              [showAnswer]="showAnswer"
              [current_Question]="current_Question">
            </viewer-question>
          </ng-container>
          <div class="flex flex-1">
            <!-- <ng-container
              *ngIf="ePrimaryCategory.PRACTICE_RESOURCE === primaryCategory && ((currentQuestionIndex+1) <= totalQCount)">
              <button *ngIf="!showAnswer" class="text-white ws-mat-primary-background margin-xs quest_btn"
                mat-raised-button (click)="checkAns(currentQuestionIndex + 1)" i18n="button quiz correct answer">
                Check Answer
              </button>
            </ng-container> -->
            <div class="flex flex-1 flex-row-reverse margin-right-m butto_box end">
              <ng-container
                *ngIf="!allSecAttempted.full && allSecAttempted.next && ((currentQuestionIndex+1) === totalQCount)">
                <button class="text-white ws-mat-primary-background margin-xs quest_btn" mat-raised-button
                  (click)="nextSection(allSecAttempted.next)" i18n="button quiz submit">
                  Next Section
                </button>
              </ng-container>
            </div>
          </div>
          <ng-template *ngIf="!(current_Question && !process)" [ngTemplateOutlet]="showLoading"></ng-template>
        </div>
      </div>
     
  </div>
  <div class="fixed-question-control">
    <div>
      <div class="flex flex-row justify-around">
        <ng-container
          *ngIf="!allSecAttempted.full && allSecAttempted.next && ((currentQuestionIndex+1) === totalQCount)">
          <button class="text-white ws-mat-primary-background quest_btn" mat-raised-button
            (click)="nextSection(allSecAttempted.next)" i18n="button quiz submit">
            Next Section
          </button>
        </ng-container>
        <a *ngIf="(currentQuestionIndex+1) !== totalQCount"
          class="text-white ws-mat-primary-background quest_btn" [ngClass]="currentQuestionIndex === 0 ? 'first' : ''" mat-button
          (click)="getNextQuestion(currentQuestionIndex + 1)">
          <ng-container>Next</ng-container>
        </a>
        &nbsp;&nbsp;
        <a *ngIf="(currentQuestionIndex + 1) === totalQCount"
          class="text-white ws-mat-primary-background quest_btn" mat-button (click)="proceedToSubmit()">
          <ng-container>Submit</ng-container>
        </a>
        &nbsp;&nbsp;
        <a *ngIf="currentQuestionIndex !== 0" class="ws-mat-accent-border quest_btn" mat-button
          (click)="getNextQuestion(currentQuestionIndex - 1)">
          <ng-container>Previous</ng-container>
        </a>
      </div>
    </div>
  </div>
  <div id="quiz-end"></div>
  <ng-container *ngIf="isSubmitted && (viewState === 'answer' || viewState === 'review')">
    <viewer-result [quizCategory]="primaryCategory" [quizResponse]="finalResponse" [percentage]="result"
      [isPassed]="finalResponse?.pass" (userSelection)="action($event)" (fetchResult)="getQuizResult()">
    </viewer-result>
  </ng-container>
  <div *ngIf="viewState === 'detail'" class="flex flex-1 flex-column">
    <ng-container *ngIf="this.paperSections && this.paperSections?.length > 0">
      <div class="flex flex-1 flex-column margin-right-m margin-left-m main_practice_box">
        <div class="margin-m" *ngIf="fetchingSectionsStatus === 'fetching'">
          <div class="flex flex-center">
            <mat-spinner></mat-spinner>
          </div>
        </div>
        <div class="flex flex-1 flex-wrap margin-top-l">
          <ng-container *ngFor="let section of this.paperSections">
            <mat-card [ngClass]="getClass(section)"
              class="min-w assessment_card ws-mat-accent-border br-8 no-border margin-m">
              <mat-card-content class="cursor-pointer"
                [class.spinner]="fetchingQuestionsStatus === 'fetching' && section.identifier === selectedSection.identifier"
                [attr.disabled]="fetchingQuestionsStatus === 'fetching' && section.identifier === selectedSection.identifier"
                (click)="startSection(section)">
                <div class="flex flex-1 flex-column">
                  <span class="flex mat-subheading-1 text-truncate ">{{section.name || 'Section'}}</span>
                  <span class="flex mat-body-2">Percentage to pass - <ng-container>
                      {{section.minimumPassPercentage}}
                    </ng-container></span>
                  <span class="flex mat-body-2">Total questions - <ng-container>{{section?.maxQuestions ||
                      '0'}}
                    </ng-container></span>
                  <span [innerHtml]="formate(section.additionalInstructions)"></span>
                </div>
              </mat-card-content>
            </mat-card>
          </ng-container>
        </div>
      </div>
    </ng-container>
  </div>
</div>
<!-- Desktop Skeleton UI -->
<div class="flex flex-row quiz-container" *ngIf="!isMobile && fetchingQuestionsStatus !== 'done' && viewState !== 'initial' 
&& !(viewState === 'answer') && !isSubmitted">          
  <div class="left-container">
    <div class="flex flex-row margin-m justify-between">
    <div>
      <div (click)="back()" class="no-border flex cursor-pointer back_button">
      <mat-icon>arrow_back</mat-icon>
      <span class="subheading-back">
        <ws-widget-skeleton-loader [width]="'182px'" [height]="'28px'"
        [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader>
      </span>
      </div>  
    </div>
    <div>             
      <div class="flex flex-1 flex-row-reverse butto_box end">
        <ws-widget-skeleton-loader [width]="'123px'" [height]="'32px'"
        [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader>
      </div>
    </div>
  </div>
    <mat-card class="flex flex-1 flex-column margin-m pad-0 quest_mat_card">
  <ng-container *ngIf="true">             
      <div class="question_container flex flex-row">
        <div class="border-outline-skeleton">
          <div class="flex flex-middle">
            <p class="margin-bottom-m">
              <ng-container i18n="question number label"><span class="subheading-1"> 
                <ws-widget-skeleton-loader [width]="'180px'" [height]="'28px'"
                [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader>
              </span></ng-container>
            </p>
          </div>
          <div class="flex flex-middle">
            <p class="margin-bottom-m">
              <ng-container i18n="question number label"><span class="subheading-1"> 
                <ws-widget-skeleton-loader [width]="'450px'" [height]="'24px'"
                [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader>
              </span></ng-container>
            </p>
          </div>
          <div class="flex flex-middle">
            <p class="margin-bottom-m">
              <ng-container i18n="question number label"><span class="subheading-1"> 
                <ws-widget-skeleton-loader [width]="'380px'" [height]="'56px'"
                [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></span>
              </ng-container>
            </p>
          </div>
          <div class="flex flex-middle">
            <p class="margin-bottom-m">
              <ng-container i18n="question number label"><span class="subheading-1"> 
                <ws-widget-skeleton-loader [width]="'380px'" [height]="'56px'"
                [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></span>
              </ng-container>
            </p>
          </div>
          <div class="flex flex-middle">
            <p class="margin-bottom-m">
              <ng-container i18n="question number label"><span class="subheading-1"> 
                <ws-widget-skeleton-loader [width]="'380px'" [height]="'56px'"
                [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></span>
              </ng-container>
            </p>
          </div>
          <div class="flex flex-middle">
            <p class="margin-bottom-m">
              <ng-container i18n="question number label"><span class="subheading-1"> 
                <ws-widget-skeleton-loader [width]="'380px'" [height]="'56px'"
                [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></span>
              </ng-container>
            </p>
          </div>
         
        </div>
       
      </div>

    
    </ng-container>
  </mat-card>
  </div>
  <div class="right-container">
    <div class="question-list">
      <div class="ques_stats_container">
        <div class="flex flex-row justify-between">
          <h3 class="mat-subheading-2">
            <p> <ws-widget-skeleton-loader [width]="'85px'" [height]="'24px'"
              [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></p>
          </h3>
          <div class="timer">
            <p> <ws-widget-skeleton-loader [width]="'102px'" [height]="'32px'"
              [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></p>
          </div>
        </div>
        <div class="seperator"></div>
        <div>
          <div class="flex flex-row justify-between">
            <div class="flex flex-col align-center">
              <div class="ques-count"> <p> <ws-widget-skeleton-loader [width]="'12px'" [height]="'24px'"
                [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></p></div>
              <div class="stats-label"> <p> <ws-widget-skeleton-loader [width]="'86px'" [height]="'16px'"
                [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></p></div>
             </div>
             <div class="flex flex-col align-center">
              <div class="ques-count"> <p> <ws-widget-skeleton-loader [width]="'12px'" [height]="'24px'"
                [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></p></div>
              <div class="stats-label"> <p> <ws-widget-skeleton-loader [width]="'86px'" [height]="'16px'"
                [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></p></div>
             </div>
             <div class="flex flex-col align-center">
              <div class="ques-count"> <p> <ws-widget-skeleton-loader [width]="'12px'" [height]="'24px'"
                [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></p></div>
              <div class="stats-label"> <p> <ws-widget-skeleton-loader [width]="'86px'" [height]="'16px'"
                [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></p></div>
             </div>
          </div>
        </div>      
        <div class="seperate-text">
          <span> <p> <ws-widget-skeleton-loader [width]="'386px'" [height]="'16px'"
            [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></p></span>
        </div>
        <div class="flex flex-row justify-between">
          
          <div class="flex flex-row center-text">
            <div class="answer-stats-label"> <p> <ws-widget-skeleton-loader [width]="'64px'" [height]="'20px'"
              [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></div>
          </div>
          <div class="flex flex-row center-text">
            <div class="answer-stats-label"> <p> <ws-widget-skeleton-loader [width]="'64px'" [height]="'20px'"
              [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></div>
          </div>
          <div class="flex flex-row center-text">
            <div class="answer-stats-label"> <p> <ws-widget-skeleton-loader [width]="'64px'" [height]="'20px'"
              [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></div>
          </div>
        </div>
      </div>
      <div class="seperator"></div>  
      <div class="flex flex-1">
        <div class="flex flex-wrap margin-right-s margin-left-s quest_num_box">
          <div class="col" *ngFor="let item of [1, 2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]">
            <div class="margin-xs">
                <ws-widget-skeleton-loader [width]="'44px'" [height]="'28px'"
                [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>          
</div>
<!-- Mobile Skeleton UI -->

<div class="flex flex-row quiz-container" *ngIf="isMobile && fetchingQuestionsStatus !== 'done' && viewState !== 'initial' && !(viewState === 'answer') && !isSubmitted">          
  <div class="flex flex-column">
      <div>
        <div class="flex flex-row justify-around align-end">
          <div>
            <span class="subheading-back">
              <ws-widget-skeleton-loader [width]="'28px'" [height]="'28px'"
              [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader>
            </span>
          </div>
          <div (click)="back()" class="no-border flex cursor-pointer back_button">
            <span class="subheading-back">
              <ws-widget-skeleton-loader [width]="'120px'" [height]="'28px'"
              [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader>
            </span>
          </div>
          <div class="timer">
            <span class="subheading-back">
              <ws-widget-skeleton-loader [width]="'120px'" [height]="'28px'"
              [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader>
            </span>
          </div>
        </div> 
        <div class="flex flex-column justify-between align-center assessment-header">           
          <div class="question-list">
            <div class="ques_stats_container">            
              <div class="mb-24">
                <div class="flex flex-row justify-around">
                  <div class="flex flex-col align-center">
                    <div class="ques-count">
                      <ws-widget-skeleton-loader [width]="'24px'" [height]="'24px'"
                          [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader>
                    </div>
                    <div class="stats-label"><p> <ws-widget-skeleton-loader [width]="'86px'" [height]="'16px'"
                      [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></p>
                    </div>
                  </div>
                  <div class="flex flex-col align-center">
                    <div class="ques-count">
                      <ws-widget-skeleton-loader [width]="'24px'" [height]="'24px'"
                          [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader>
                    </div>
                    <div class="stats-label"><p> <ws-widget-skeleton-loader [width]="'86px'" [height]="'16px'"
                      [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></p>
                    </div>
                  </div>
                  <!-- <div class="flex flex-col align-center">
                    <div class="ques-count">{{markedQuestions.size}}</div>
                    <div class="stats-label">Skipped</div>
                  </div> -->
                </div>
              </div>
              <div class="">
                <span><span> <p> <ws-widget-skeleton-loader [width]="'386px'" [height]="'16px'"
                  [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></p></span></span>
              </div>
              
          </div>
            
          </div>   
          <div>
            
            <!-- <div class="flex flex-row justify-between" *ngIf="!expandFalse">                  
              <div class="flex flex-row center-text">
                <div class="answer-stats-label">Answered&nbsp;</div>
                <div><mat-chip-list><mat-chip class="light-blue-small">&nbsp;&nbsp;&nbsp;&nbsp;</mat-chip></mat-chip-list></div>
              </div>
              <div class="flex flex-row center-text answer-stats-label">
                Not Answered &nbsp;<mat-checkbox class="example-margin"></mat-checkbox>
              </div>
              <div class="flex flex-row center-text">
                <div class="answer-stats-label">Skipped&nbsp;</div>
                <div><mat-chip class="orange-small">&nbsp;&nbsp;&nbsp;&nbsp;</mat-chip></div>
              </div>
            </div> -->
           
            <div *ngIf="!isSubmitted && viewState === 'attempt' && !expandFalse" class="flex flex-1">
              <ng-template *ngIf="fetchingQuestionsStatus === 'fetching'" [ngTemplateOutlet]="showLoading"></ng-template>
              <div class="flex flex-nowrap margin-right-s margin-left-s quest_num_box"
                *ngIf="fetchingQuestionsStatus === 'done'">
                <div class="col" *ngFor="let question of secQuestions; let i = index">
                  <div (click)="scroll(i + 1)" [ngClass]="{
                    'marked-question': isQuestionMarked(question?.questionId),
                    'attempted-question':
                      !isQuestionMarked(question?.questionId) &&
                      isQuestionAttempted(question?.questionId),
                    'white-border':
                      !isQuestionMarked(question?.questionId) &&
                      !isQuestionAttempted(question?.questionId) &&
                      currentTheme === 'black-theme',
                    'dark-border':
                      !isQuestionMarked(question?.questionId) &&
                      !isQuestionAttempted(question?.questionId) &&
                      currentTheme !== 'black-theme'
                  }" class="margin-xs">
                    <div *ngIf="!isQuestionMarked(question?.questionId) &&
                      isQuestionAttempted(question?.questionId)">
                      <mat-chip-list><mat-chip class="light-blue-small">&nbsp;&nbsp;&nbsp;&nbsp;</mat-chip></mat-chip-list>
                    </div>
                    <div *ngIf="isQuestionMarked(question?.questionId) && !(!isQuestionMarked(question?.questionId) &&
                      isQuestionAttempted(question?.questionId))">
                      <mat-chip-list><mat-chip class="orange-small">{{ i + 1 }}</mat-chip></mat-chip-list>
                    </div>
                    <div *ngIf="!(!isQuestionMarked(question?.questionId) &&
                      isQuestionAttempted(question?.questionId)) && (!isQuestionMarked(question?.questionId))"
                      class="ovel question-number"><span class="mat-body-2">
                        {{ i + 1 }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
          </div>
        </div>
        <div class="question_container flex flex-row">
          <div class="border-outline-skeleton">
            <div class="flex flex-middle">
              <p class="margin-bottom-m">
                <ng-container i18n="question number label"><span class="subheading-1"> 
                  <ws-widget-skeleton-loader [width]="'180px'" [height]="'28px'"
                  [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader>
                </span></ng-container>
              </p>
            </div>
            <div class="flex flex-middle">
              <p class="margin-bottom-m">
                <ng-container i18n="question number label"><span class="subheading-1"> 
                  <ws-widget-skeleton-loader [width]="'320px'" [height]="'24px'"
                  [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader>
                </span></ng-container>
              </p>
            </div>
            <div class="flex flex-middle">
              <p class="margin-bottom-m">
                <ng-container i18n="question number label"><span class="subheading-1"> 
                  <ws-widget-skeleton-loader [width]="'300px'" [height]="'56px'"
                  [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></span>
                </ng-container>
              </p>
            </div>
            <div class="flex flex-middle">
              <p class="margin-bottom-m">
                <ng-container i18n="question number label"><span class="subheading-1"> 
                  <ws-widget-skeleton-loader [width]="'300px'" [height]="'56px'"
                  [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></span>
                </ng-container>
              </p>
            </div>
            <div class="flex flex-middle">
              <p class="margin-bottom-m">
                <ng-container i18n="question number label"><span class="subheading-1"> 
                  <ws-widget-skeleton-loader [width]="'300px'" [height]="'56px'"
                  [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></span>
                </ng-container>
              </p>
            </div>
            <div class="flex flex-middle">
              <p class="margin-bottom-m">
                <ng-container i18n="question number label"><span class="subheading-1"> 
                  <ws-widget-skeleton-loader [width]="'300px'" [height]="'56px'"
                  [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></span>
                </ng-container>
              </p>
            </div>
           
          </div>
         
        </div>
      </div>
     
  </div>
  <div class="fixed-question-control">
    <div>
      <div class="flex flex-row justify-around">
        <p> <ws-widget-skeleton-loader [width]="'320px'" [height]="'32px'"
          [bindingClass]="'flex h-16'"></ws-widget-skeleton-loader></p>
      </div>
    </div>
  </div>        
</div>
<!-- do not delete this
  {{'current Q'}}===={{current_Question | json}}
<br>
{{'process'}}===={{!process}}
<br>
{{'viewState'}} ===>{{viewState }}
<br>
{{'isSubmitted'}}=====>{{isSubmitted}} -->


<ng-template #timer>
  <div *ngIf="timeLeft" class="flex flex-1 flex-center">
    <img src="assets/icons/final-assessment/timer.svg">
    &nbsp;&nbsp;
    <ng-container *ngIf="quizJson.timeLimit >= 3600">
      <div *ngIf="timeLeft > 120">
        <span class="time-title ws-mat-default-text"> {{ timeLeft | pipeDurationTransform: 'hms2H' }}</span>
      </div>
      <div *ngIf="timeLeft <= 120" class="ws-mat-red-text">
        <span class="time-title ws-mat-red-text"> {{ timeLeft | pipeDurationTransform: 'hms2H' }}</span>
      </div>
    </ng-container>
    <ng-container *ngIf="quizJson.timeLimit < 3600">
      <div *ngIf="timeLeft > 120">
        <span class="time-title ws-mat-default-text"> {{ timeLeft | pipeDurationTransform: 'hms2M' }}</span>
      </div>
      <div *ngIf="timeLeft <= 120" class="ws-mat-red-text">
        <span class="time-title ws-mat-red-text"> {{ timeLeft | pipeDurationTransform: 'hms2M' }}</span>
      </div>
    </ng-container>

    <div *ngIf="isSubmitted" class="margin-left-xs mat-body-strong" i18n>
      <span class="time-title ws-mat-default-text"> (Submitted)</span>
    </div>
  </div>
</ng-template>

<ng-template #indicator>
  <div class="margin-m">
    <div class="flex flex-end indicator_box">
      <span class="flex">
        <div class="sbox complete"></div>
        Completed
      </span>
      <span class="flex">
        <div class="sbox incomplete"></div>
        Incomplete
      </span>
      <span class="flex">
        <div class="sbox not-started"></div>
        Not Started
      </span>
      <span class="flex">
        <div class="sbox selected"></div>
        Selected
      </span>
    </div>
  </div>
</ng-template>

<ng-template #showLoading>
  <div class="margin-m">
    <div class="flex flex-center">
      <mat-spinner></mat-spinner>
    </div>
  </div>
</ng-template>

<div class="calculate-overlay" *ngIf="showOverlay"> 
  <div class="overlay">
    <div>      
        <mat-spinner [diameter]="150" ></mat-spinner>
    </div>
    <div>
      <span class="mat-heading" i18n>Be patient please, while we calculate your result!</span>
    </div>
  </div>
   
</div>