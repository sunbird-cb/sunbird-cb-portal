<div class="flex auto-w ws-mat-primary-lite-background-important result_main">
  <div class="flex flex-1 max-w relative result_image_box">
    <div class="flex percent-div">
      <div class="flex flex-1 flex-column flex-center center">
        <ng-container *ngIf="questionTYP.FINAL_ASSESSMENT === quizCategory && quizResponse && !quizResponse?.isInProgress">
          <!-- <mat-icon *ngIf="isPassed" class="ws-mat-green-2-text transform15 margin-top-m">check_circle</mat-icon>
          <mat-icon *ngIf="!isPassed" class="ws-mat-red-text transform15 margin-top-m">highlight_off</mat-icon>
          <span *ngIf="isPassed" class="mat-title ws-mat-black60-text margin-top-s">{{levelText || 'Passed'}}</span>
          <span *ngIf="!isPassed" class="mat-title ws-mat-black60-text margin-top-s">{{levelText || 'Failed'}}</span>
          <span class="mat-heading-1 ws-mat-default-text">{{(percentage || 0) | number: '1.2-2'}}%</span>
          <span class="mat-body-1 ws-mat-black60-text">your score</span> -->
          
          <div *ngIf="isPassed && percentage === 100" class="msg-box">
            <mat-icon  class="ws-mat-green-2-text transform15 margin-top-m">check_circle</mat-icon>
            <span class="mat-body-3 ws-mat-black60-text margin-top-s text-block">{{levelText || 'Passed'}}</span>
            <span class="mat-body-2 ws-mat-default-text">{{(percentage || 0) | number: '1.2-2'}}%</span>
            <span class="mat-body-2 ws-mat-black60-text"> {{ 'quizresult.score' | translate }}</span>
            <span class="mat-body-2 text-block">{{ 'quizresult.hurray' | translate }}</span>
            <span class="mat-body-2 ws-mat-black60-text text-block attempt-text">{{ 'quizresult.passMsg1' | translate }}</span>
          </div>

          <div *ngIf="isPassed && percentage < 100" class="msg-box">
            <mat-icon  class="ws-mat-green-2-text transform15 margin-top-m ">check_circle</mat-icon>
            <span class="mat-body-3 ws-mat-black60-text margin-top-s text-block">{{levelText || 'Passed'}}</span>
            <span class="mat-body-2 ws-mat-default-text">{{(percentage || 0) | number: '1.2-2'}}%
              <span class="mat-body-2 ws-mat-black60-text"> {{ 'quizresult.score' | translate }}</span>
            </span>
            <span class="mat-body-2 ws-mat-black60-text text-block attempt-text">{{ 'quizresult.passMsg2' | translate }}</span>
          </div>

          <div *ngIf="!isPassed" class="msg-box">
            <mat-icon class="ws-mat-red-text msg-icon transform15 margin-top-m">highlight_off</mat-icon>
            <span class="mat-body-3 ws-mat-black60-text margin-top-s text-block">{{levelText || 'Failed'}}</span>
            <!-- <span class="mat-body-2 padding-s text-block">No worries!</span>
            <span class="mat-body-2 ws-mat-black60-text text-block attempt-text">Your next try is a chance to do even better.</span> -->
            <span class="mat-body-2 ws-mat-default-text">{{(percentage || 0) | number: '1.2-2'}}%</span>
            <span class="mat-body-2 ws-mat-black60-text"> {{ 'quizresult.score' | translate }}</span>
            <span class="mat-body-2 ws-mat-black60-text text-block attempt-text">{{ 'quizresult.passMsg3' | translate }}</span>
          </div>
        </ng-container>
        <ng-container *ngIf="questionTYP.PRACTICE_RESOURCE === quizCategory">
          <mat-icon class="ws-mat-green-2-text transform15 margin-top-m">check_box</mat-icon>
          <span class="ws-mat-black60-text margin-top-s padding-s attempt-text">{{ 'Well done, Keep learning!'}}</span>
        </ng-container>
      </div>
    </div>
    <img class="flex-1 result_image" [src]="staticImage" alt="exam image" />
  </div>
  <div class="flex flex-1 flex-column result_text_box ws-mat-accent-border border-custom">
    <div class="flex flex-1 flex-column flex-wrap margin-top-m">
      <ng-container *ngIf="!(quizResponse)">
        <div class="flex flex-1 flex-center text-center flex-middle">
          <span class="mat-heading" i18n>{{ 'quizresult.bePatienWhileWeCalculate' | translate }}</span>
          <mat-spinner></mat-spinner>
        </div>
      </ng-container>
      <ng-container *ngIf="quizResponse && quizResponse?.isInProgress">
        <div class="flex flex-row flex-center text-center flex-middle margin-top-xl">
          <!-- <span class="mat-heading" i18n>We are not able to fetch the result</span> -->
          <span class="mat-heading" i18n>{{ 'quizresult.submittedSucessfull' | translate }}</span>
        </div>
        <div class="flex flex-row flex-center text-center flex-middle margin-top-xl">
          <button mat-button  class="ws-mat-primary-background text-white m-w padding-xs" (click)="retryResult()">
            <mat-icon>refresh</mat-icon> {{ 'quizresult.retry' | translate }}</button>
        </div>
      </ng-container>
      <ng-container *ngIf="checkRes()">
        <div class="flex flex-row flex-center text-center flex-middle margin-top-xl">
          <span class="mat-heading" i18n><mat-icon class="font-size-50">warning</mat-icon></span>
        </div>
        <div class="flex flex-row flex-center text-center flex-middle margin-top-m padding-left-l">
          <span class="mat-heading" i18n>{{quizResponse}}</span>
        </div>
        <div class="flex flex-row flex-center text-center flex-middle margin-top-m padding-left-l">
          <span class="mat-heading" i18n>{{ 'quizresult.pleaseContactSystemAdmin' | translate }}</span>
        </div>
      </ng-container>
      <ng-container *ngIf="quizResponse && !quizResponse?.isInProgress">
        <ng-container *ngFor="let _parts of quizResponse?.children; let i = index">
          <mat-card *ngIf="_parts" class="ws-mat-accent-border box-c result_box">
            <mat-card-title>
              <span class="mat-subheading-1" *ngIf="!isOnlySection">{{'Section ' + (i+1)}}</span>
              <!-- <span class="mat-subheading-1" *ngIf="isOnlySection">{{'Default Section'}}</span> -->
              <!-- <span class="mat-subheading-2 block ws-mat-black60-text">{{'Insights'}}</span> -->
              <span class="mat-subheading-1" *ngIf="isOnlySection">{{ 'Your Performance Summary'}}</span> 
            </mat-card-title>
            <mat-card-content class="flex flex-1 flex-column">
              <ng-container *ngFor="let _result of ['correct','inCorrect','incorrect','blank']">
                <ng-container *ngIf="_parts[_result]">
                  <ng-container *ngIf="_result == 'correct'" [ngTemplateOutlet]="testdetail" [ngTemplateOutletContext]="{data: {
                icon: 'done',
                isSVG: false,
                colorClass: 'green',
                text: _parts[_result] +' Correct',
                type: _result,
                sectionType: 'Section' + (i)+_result,
                children:_parts['children']}
              }"></ng-container>
                  <ng-container *ngIf="_result === 'inCorrect' || _result ===  'incorrect'" [ngTemplateOutlet]="detail"
                    [ngTemplateOutletContext]="{ data:{
                icon: 'close',
                isSVG: false,
                colorClass: 'red',
                text: _parts[_result] + ' Incorrect',
                type: _result,
                sectionType: 'Section' + (i)+_result,
                children:_parts['children']
              }}"></ng-container>
                  <ng-container *ngIf="_result == 'blank'" [ngTemplateOutlet]="detail" [ngTemplateOutletContext]="{data:{
                icon: 'close',
                isSVG: false,
                colorClass: 'red',
                text: _parts[_result] + ' Not Attempted',
                type: _result,
                sectionType: 'Section' + (i)+_result,
                children:_parts['children']
              }}"></ng-container>
                </ng-container>
              </ng-container>
            </mat-card-content>
          </mat-card>
        </ng-container>
      </ng-container>
    </div>
    <ng-container
      *ngIf="questionTYP.PRACTICE_RESOURCE === quizCategory && (quizResponse?.children && quizResponse?.children?.length > 0)">
      <div class="flex flex-1 flex-center">
        <a mat-button (click)="action('retake')" class="width-1-1 text-white ws-mat-primary-background retake">
          {{ 'quizresult.retakeAssessment' | translate }}
        </a>
      </div>
    </ng-container>
  </div>
  <div class="flex flex-1 ">
    <div class="p-4 w-full question-list" *ngIf="selectedQuestionData">
      <p class="question-section">{{selectedQuestionData.text}} </p>
      <div *ngIf="selectedQuestionData.children">
        <ng-container *ngFor="let question of selectedQuestionData.children;let i = index">
          <ng-container *ngIf="selectedQuestionData.type === question.result">
            <mat-accordion class="example-headers-align m-3">
                  <mat-expansion-panel class="questionPanel bg-gray-accordian" hideToggle="true"  #example>
                    <mat-expansion-panel-header class="question-header">
                      <mat-panel-title class="mr-0">
                        <mat-panel-description class="panel-description">
                          <p>{{ 'practiceoverview.question' | translate }} {{i+1}}</p>
                          <mat-icon *ngIf="!example.expanded">add</mat-icon>
                          <mat-icon *ngIf="example.expanded">close</mat-icon>
                        </mat-panel-description>
                      </mat-panel-title>
                    </mat-expansion-panel-header>
                      <div>
                        <p class="display-ques">{{question.question}}</p>
                      </div>
                  </mat-expansion-panel>
            </mat-accordion>

        </ng-container>
      </ng-container>
      </div>
    </div>
  </div>
</div>
<ng-template #detail let-data="data" >
  <mat-card [ngClass]="{'highlight': selectedQuestionData?.sectionType === data.sectionType}" class="flex max-card-w customcard flex-jc-space-between cursor-pointer margin-top-xs bg-gray" (click)="getQuestionCount(data)">
    <div class="flex">
      <mat-icon [style.color]="data.colorClass">{{data.icon}}</mat-icon>
      <span class="mat-body-2 margin-left-xs">{{data.text}}</span>
    </div>
    <mat-icon >chevron_right</mat-icon>
  </mat-card>
</ng-template>

<ng-template #testdetail let-data="data" >
  <mat-card class="flex max-card-w customcard flex-jc-space-between cursor-pointer margin-top-xs bg-gray" [ngClass]="{'highlight': selectedQuestionData?.sectionType === data.sectionType}" (click)="getQuestionCount(data)">
    <div class="flex">
      <mat-icon [style.color]="data.colorClass" *ngIf="!data.isSVG">{{data.icon}}</mat-icon>
      <img *ngIf="data.isSVG" [style.color]="data.colorClass" [src]="data.icon" alt="Assessment" class="margin-right-xs">
      <span class="mat-body-2 margin-left-xs">{{data.text}}</span>
    </div>
    <mat-icon >chevron_right</mat-icon>
  </mat-card>
</ng-template>

